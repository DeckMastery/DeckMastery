<!doctype html>
<html lang="ar" dir="rtl">
<head>
  <script>
    (function(){
      try{
        const lang = localStorage.getItem('dm_lang') || 'ar';
        document.documentElement.lang = (lang==='en') ? 'en' : 'ar';
        document.documentElement.dir  = (lang==='en') ? 'ltr' : 'rtl';

        const theme = localStorage.getItem('dm_theme') || 'light';
        document.documentElement.dataset.theme = (theme === 'dark') ? 'dark' : 'light';
      }catch(e){}
    })();
  </script>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, viewport-fit=cover, user-scalable=no"/>
  <title>DeckMastery</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">

  <!-- Font Awesome for the new UI icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <link rel="stylesheet" href="./css/styles.css"/>
</head>
<body>
  <!-- Kept for backward compatibility (unused in the new UI) -->
  <div id="bg" aria-hidden="true"></div>

  <div class="app-container">
    <header class="topbar" id="topbar">
      <button class="profile-card" id="btnProfile" data-sfx="naker" aria-label="الملف الشخصي" type="button">
        <div class="avatar-stack" id="avatarStack" aria-hidden="true"></div>
        <div class="profile-text">
          <div class="profile-name" id="uiName"></div>
          <div class="user-meta">
            <span id="uiRank" class="meta-pill"></span>
            <span id="uiLevel" class="meta-pill"></span>
          </div>
          <div class="progress-bar-bg" aria-hidden="true"><div class="progress-fill" id="uiXpFill"></div></div>
        </div>
      </button>

      <div class="gold-tag" id="goldTag" aria-label="الذهب">
        <i class="fas fa-coins"></i>
        <span id="uiGold">0</span>
      </div>
    </header>

    <div class="top-nav" id="topNav">
      <button class="nav-btn btn-active" id="btnStreak" data-sfx="tap_secondary" type="button">
        <i class="fas fa-fire" style="color:orange"></i>
        <span class="nav-label"><span id="lblStreak">الحماس</span> <span class="badge" id="uiStreak">0</span></span>
      </button>

      <button class="nav-btn btn-active" id="btnNotifications" data-sfx="tap_secondary" type="button">
        <i class="fas fa-bell"></i>
        <span class="nav-label" id="lblNotifications">الإشعارات</span>
        <span class="dot" id="uiNotiDot" hidden></span>
      </button>

      <button class="nav-btn btn-active" id="btnHelp" data-sfx="naker" type="button">
        <i class="fas fa-question-circle"></i>
        <span class="nav-label" id="lblHelp">التعليمات</span>
      </button>

      <button class="nav-btn btn-active" id="btnSettings" data-sfx="naker" type="button">
        <i class="fas fa-user-cog"></i>
        <span class="nav-label" id="lblSettings">الإعدادات</span>
      </button>
    </div>

    <main id="app" class="app" role="main"></main>

    <div id="modalRoot"></div>
  </div>

  <!-- Optional: animation + confetti (UI polish). App falls back gracefully if blocked. -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.3/dist/confetti.browser.min.js"></script>

  <script type="module" src="./js/app.js"></script>
</body>
</html>
